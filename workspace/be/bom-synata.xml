<?xml version="1.0" encoding="UTF-8"?>
<!-- For any panel, the type determines the layout and class. The combination of 
      type and sub-type must be unique. If missing, the subtype is taken to be the
      same as the type. Within a panel, an artifact name/version combination must 
      be unique. 
 -->
<installer>
	<title>SynataBatchExpert+</title>
	<description>Installer for ILS Automation's Batch Expert+ for Synata</description>
	<property name="product">BatchExpert+</property>
	<property name="release">@RELEASE@</property>
	<property name="date">@DATE@</property>
	<property name="version">69</property>
	<!-- These entries define the install panels and their order -->
	<!-- The welcome panel must always be displayed, thus no version -->
	<panel type="welcome" essential="true">
		<title>ILS Automation Installer for Batch Expert+ </title>
		<preamble>This is a special version of the ILS Automation installer built for
			a new installation at &quot;Synata&quot;.
			Before continuing, please make sure that you have 
			defined a database connection, e.g. BEDB, to hold your configuration and results.
			This installer is designed to run on a clean installation of Ignition.
		</preamble>
		<artifact name="notes" type="pdf">
			<location>artifacts/doc/ReleaseNotes.pdf</location>
		</artifact>
	</panel>
	<panel type="license" essential="true" version="3">
		<title>End User License Agreement (EULA)</title>
		<preamble>Click on the button below to view the license that specifies
			permissible use of the software to be installed. Select the checkbox
			to indicate acceptance of the terms.
			You must accept the license terms to proceed.
		</preamble>
		<artifact name="license" type="html">
			<location>artifacts/license/license.html</location>
		</artifact>
	</panel>
	<panel type="tag" subtype="production" essential="true" version="11">
		<title>Install UDT Definitions</title>
		<preamble>This page defines UDTs for common  controllers.
		           These definitions are written to the default tag provider.
		</preamble>
		<property name="provider" type="production">default</property>
		<property name="base" >[default]_types_</property>
		<artifact name="UDT Definitions" type="tag" subtype="xml">
			<location>artifacts/tags/udts.xml</location>
		</artifact>
	</panel>
		<!-- Python source files are copied into the Ignition user-lib/pylib area.
	     Jar files are copied into lib -->
	<panel type="file" essential="true" version="33">
		<title>Python Extensions for Batch Expert+</title>
		<preamble>This page loads the custom Python modules that support Batch Expert+. 
		</preamble>
		<artifact name="External Python for Batch Expert+" type="directory" subtype="user-lib">
			<location>artifacts/external/ils</location>
			<destination>pylib/ils</destination>
		</artifact>
		<artifact name="ILS jar files for Batch Expert+" type="directory" subtype="lib">
			<location>artifacts/external/lib</location>
			<destination>core/common</destination>
		</artifact>>
		<artifact name="XLSXWriter" type="directory" subtype="user-lib">
			<location>artifacts/external/xlsxwriter</location>
			<destination>pylib/xlsxwriter</destination>
		</artifact>
	</panel>
	<panel type="tag" subtype="production" essential="true" version="11">
		<title>Install Configuration Tags</title>
		<preamble>Create configuration tags that hold information on which batch-tracking parameters 
		         are important in your installation.
		</preamble>
		<property name="provider" type="production">default</property>
		<property name="historyprovider" type="production"></property>
		<property name="base" >[default]</property>
		<artifact name="Configuration Tags" type="tag" subtype="xml">
			<location>artifacts/tags/configurationTags.xml</location>
		</artifact>
		<artifact name="Default folders for Site Tags" type="tag" subtype="xml">
			<location>artifacts/tags/udts_new.xml</location>
		</artifact>
	</panel>
	<panel type="definition" essential="true">
		<title>Define the Database Connection</title>
		<preamble>Specify the database connection and DBMS-type that 
		          are used for BatchExpert+.
		</preamble>
		<property name="database" type="production">
			<script>ils.be.configuration.config.setDatasource</script>
		</property>
		<property name="DBMS" type="production">
			<script>ils.be.configuration.config.setDBMS</script>
		</property>
		<property name="provider" type="production">default</property>
	</panel>
	<!-- 
	<panel type="scanclass" essential="false" version="3">
		<title>Create alternative Scan Classes</title>
		<preamble>Create scanclasses referenced by application tags. 
				Scanclasses determine tag poll rates.
		</preamble>
		<property name="provider">default</property>
		<artifact name="Production ScanClasses" type="scanclass" subtype="csv">
			<location>artifacts/scanclass/scanclasses.csv</location>
		</artifact>
	</panel>
	 -->
	<panel type="feature" essential="true">
		<title>Batch-Expert Feature Selection</title>
		<preamble>Configure the Batch-Expert+ installation to include the SFC and other optional features. Note that these
		          features are record as tag values. These decisions are, therefore, easily reversed. 
		</preamble>
		<!-- script defines python to execute on feature installation -->
		<artifact name="CAMPAIGN">
			<comment>Configure Batch Expert+ to add campaign as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByCamapign</script>
		</artifact>
		<artifact name="CODE">
			<comment>Configure Batch Expert+ to add batch code as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByCode</script>
		</artifact>
		<artifact name="CONDITION">
			<comment>Configure Batch Expert+ to add condition as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByCondition</script>
		</artifact>
		<artifact name="CUSTOMER">
			<comment>Configure Batch Expert+ to add customer as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByCustomer</script>
		</artifact>
		<artifact name="EFT">
			<comment>Configure Batch Expert+ to add auto EFT clearance as a feature.</comment>
			<script>ils.be.configuration.config.setAutoClearEFT</script>
		</artifact>
		<artifact name="FERMENTATION">
			<comment>Configure Batch Expert+ to add fermentation (organism) as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByFermentation</script>
		</artifact>
		<artifact name="OWNER">
			<comment>Configure Batch Expert+ to add owner as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByOwner</script>
		</artifact>
		<artifact name="PRODUCT">
			<comment>Configure Batch Expert+ to add product as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByProject</script>
		</artifact>
		<artifact name="PROJECT">
			<comment>Configure Batch Expert+ to add project as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByProduct</script>
		</artifact>
		<artifact name="RESOURCE">
			<comment>Configure Batch Expert+ to add resource as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByResource</script>
		</artifact>
		<artifact name="SEED">
			<comment>Configure Batch Expert+ to add seed as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchBySeed</script>
		</artifact>
		<artifact name="SETUP">
			<comment>Configure Batch Expert+ to add setup as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchBySetup</script>
		</artifact>
		<artifact name="SFC">
			<comment>Enable Sequential Functional Charts (SFCs) within Batch-Expert. Use of this 
		         feature requires the Ignition SFC module and involves installation of a custom SFC module from ILS.</comment>
			<script>ils.be.configuration.config.setUseSFC</script>
		</artifact>
		<artifact name="STRAIN">
			<comment>Configure Batch Expert+ to add strain as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByStrain</script>
		</artifact>
		<artifact name="VESSEL">
			<comment>Configure Batch Expert+ to add vessel id as a parameter for batch tracking.</comment>
			<script>ils.be.configuration.config.setTrackBatchByVessel</script>
		</artifact>
	</panel>
	<panel type="icon" essential="true" version="4">
		<title>Icons</title>
		<preamble>A small number of custom icons are used in Vision screens. This panel installs them. </preamble>
		<artifact name="Custom Icons" type="ils" subtype="icon">
			<location>artifacts/icons</location>
		</artifact>
	</panel>
	<panel type="python" essential="false" version="6">
		<title>Database Scripts for Batch Expert+ Testing</title>
		<preamble>This page recreates the database schema to BatchExpert+ 3.1. First drop,
		          then create. On the next tab we populate the tables to support the units that are 
		          already defined by tags.
		</preamble>
		<artifact name="Drop Tables" type="drop">
			<comment>Clear the existing database of all tables, procedures and indices. This step is only needed
			         if the database is to be completely re-created.</comment>
			<script>ils.be.database.bedb.clearDatabase()</script>
		</artifact>
		<artifact name="Create Tables" type="create">
			<script>ils.be.database.bedb.createDatabase()</script>
			<comment>Create tables and indices required for Batch Expert.</comment>
		</artifact>
	</panel>
	<panel type="python" essential="true" version="13">
		<title>Database Scripts for Batch Expert+ 3.1</title>
		<preamble>This page updates the installed database schema to BatchExpert+ 2.4. 
				We also populate the tables with common choose list entries.
		</preamble>
		<artifact name="Alter Tables" type="alter">
			<script>ils.be.database.alter.alterDatabase()</script>
			<comment>Update table structure for BE+ 3.1.</comment>
		</artifact>
		<artifact name="Populate Tables" type="insert">
			<script>ils.be.database.bedb.initializeDatabase()</script>
			<comment>Populate tables with common choose-list entries.</comment>
		</artifact>
	</panel>
	<panel type="database" essential="false" version="6">
		<title>Database Scripts for Batch Expert+ Testing - MYSQL</title>
		<preamble>This page populates MYSQL tables with Synata-specific entries to support the units that are 
		          already defined by tags. NOTE: This script is not compatible with SQLSERVER.
		</preamble>
		<property name="database" type="production"></property>
		<property name="dbms" type="MYSQL"></property>
		<!-- Recognized subtypes are: clear, create, alter -->
		<artifact name="BEDB Database" type="sql" subtype="alter">
			<comment>Populate tables to match tags and transaction groups specifically for our Synata batches.</comment>
			<location>artifacts/database/mysql/populate.sql</location>
		</artifact>
	</panel>
	<panel type="tag" subtype="production" essential="false" version="5">
		<title>Update Tag Definitions for Synata Units and Instruments</title>
		<preamble>Update UDTs used by Synata fermenters.
		</preamble>
		<property name="provider" type="production">default</property>
		<property name="historyprovider" type="production"></property>
		<property name="base" >[default]_types_</property>
		<artifact name="Synata Instrument Tag Definitions" type="tag" subtype="xml">
			<location>artifacts/tags/synata_instrument_udt_tags.xml</location>
		</artifact>
		<artifact name="Synata Unit Tag Definitions" type="tag" subtype="xml">
			<location>artifacts/tags/synata_unit_udt_tags.xml</location>
		</artifact>
	</panel>
	<panel type="tag" subtype="production" essential="false" version="4">
		<title>Install Tag Definitions for TEST ONLY</title>
		<preamble>This page creates tags corresponding to Synata fermenters.
		          Do NOT use in for production. These tags are for test systems only.
		          The definitions, like all BE tags, are written to the &quot;default&quot; tag provider.
		</preamble>
		<property name="provider" type="production">default</property>
		<property name="historyprovider" type="production"></property>
		<property name="base" >[default]</property>
		<artifact name="Synata Unit Tags" type="tag" subtype="xml">
			<location>artifacts/tags/synata_unit_tags.xml</location>
		</artifact>
	</panel>
	<panel type="project" subtype="main" essential="true" version="32">
		<title>Install the BatchExpert+ Master Project</title>
		<preamble>The BatchExpert+ &quot;Master&quot; project contains standard
			windows and tags. These are globally applicable to all customers.
			Upon an update this is the project that gets changed.
		</preamble>
		<property name="provider" type="production">default</property>
		<!-- For projects, artifact subtypes are: full, partial and global
		     There can be at most one artifact of each type -->
		<artifact name="BatchExpertMaster31" type="project">
			<location>artifacts/projects/BatchExpertMaster.zip</location>
			<comment>Install the latest Master project. It will be loaded with a name that includes the current version.</comment>
		</artifact>
	</panel>
	<panel type="project" subtype="main" essential="true" version="33">
		<title>Install BatchExpert+ 3.1 - Specially assembled for Synata
		</title>
		<preamble>Create Batch Expert+ 3.1 for Synata. This project includes 
		          Synata-specific configuration.
		</preamble>
		<!-- For projects, artifact subtypes are: full, partial and global -->
		<artifact name="BatchExpertSynata31" type="project" subtype="full">
			<location>artifacts/projects/BatchExpertSynata.zip</location>
			<comment>Create a BatchExpert+ 3.1 project for Synata. </comment>
		</artifact>
	</panel>
	<!-- The summary panel must always be displayed, thus no version -->
	<panel type="summary" essential="true">
		<title>Installation Summary</title>
		<preamble>The list below shows which of the installation steps have been completed.
		 Selecting "Finish" will record the current version of BatchExpert+ in
			the Gateway internal database.
		</preamble>
	</panel>
	<!-- The completion page is displayed on finish. Use it to display post-install instructions. -->
	<epilog>
		<title>Installation Complete</title>
		<preamble>The automated installation and configuration of Batch Expert+
		          is complete. There are just a few more manual steps required. </preamble>
		<note name="Site Project">The site-specific project currently inherits from a prior version of the Master. Update it to refer to the newly installed Master.</note>
		<note name="Gateway Restart">The tags have active components. A Gateway restart is required to accommodate the changes.</note>
	</epilog>
</installer>

